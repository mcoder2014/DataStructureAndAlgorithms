# malloc和new的区别
**C++中有了malloc / free , 为什么还需要 new / delete**

1.	malloc与free是C++/C语言的标准库函数，new/delete是C++的运算符。它们都可用于申请动态内存和释放内存。
2.	对于非内部数据类型的对象而言，光用malloc/free无法满足动态对象的要求。对象在创建的同时要自动执行构造函数，对象在消亡之前要自动执行析构函数。因此C++语言需要一个能完成动态内存分配和初始化工作的运算符new，以一个能完成清理与释放内存工作的运算符delete。
3.	new能够自动计算需要分配的内存空间，而malloc需要手工计算字节数：
```
int * p1=new int[2];
int * p2=(int*)malloc(sizeof(int) *2);
```
4.	new的返回值不需要强制类型转换，因为new内置了sizeof()、类型转换和类型安全检查；而malloc返回void类型的指针，它本身并不识别内存是什么类型，它只关心内存的总字节数，因此需要强制类型转换。
5.	new 是安全的，会进行类型检查 
```
//int * p1= new float[2];编译时报错
```
6.	new一般由两部分组成，分别是new操作和构造
7.	malloc/free需要库函数<stdlib.h>支持
8.	内存释放：如果申请内存后不进行内存释放，就会出现内存泄露问题，所以new/delete、malloc/free必须配对使用。而且delete和free被调用后，内存不会立即收回，指针也不会指向空，而是仅仅告诉操作系统，这一块内存被释放了，可以用作其他用途。由于没有对这块内存进行写操作，所以内存中的变量数值并没有发生改变，出现野指针的情况，因此delete和free后，需要将指针指向置空。


# malloc 的原理
1. brk
2. 三个内存分配函数

# 堆内存管理