# 微服务

## 什么是微服务

单个轻量级服务一般为一个单独微服务，微服务讲究的是 专注某个功能的实现，比如登录系统只专注于用户登录方面功能的实现，讲究的是职责单一，开箱即用，可以独立运行。微服务架构系统是一个分布式的系统，按照业务进行划分服务单元模块，解决单个系统的不足，满足越来越复杂的业务需求。

通常而言，微服务架构是一种架构模式或者说是架构风格，它提倡将单一应用程序划分成一组小的服务。每个服务运行在其独立的自己的进程中服务之间相互配合、相互协调，为用户提供最终价值。服务之间采用轻量级通信。每个服务都围绕具体业务进行构建，并能够独立部署到生产环境等。另外应尽量避免统一的、集中的服务管理机制。

## 微服务间如何通信

同步通信：

* RPC 远程调用；
* REST 接口调用；

异步通信：消息队列等；

## Spring Cloud 和 Dubbo 区别

首先，他们都是分布式管理框架。

dubbo 是二进制传输，占用带宽会少一点。SpringCloud是http 传输，带宽会多一点，同时使用http协议一般会使用JSON报文，消耗会更大。

dubbo 开发难度较大，所依赖的 jar 包有很多问题大型工程无法解决。SpringCloud 对第三方的继承可以一键式生成，天然集成。

SpringCloud 接口协议约定比较松散，需要强有力的行政措施来限制接口无序升级。

最大的区别: **Spring Cloud抛弃了Dubbo 的RPC通信，采用的是基于HTTP的REST方式。**

严格来说，这两种方式各有优劣。虽然在一定程度上来说，后者牺牲了服务调用的性能，但也避免了上面提到的原生RPC带来的问题。而且REST相比RPC更为灵活，服务提供方和调用方的依赖只依靠一纸契约，不存在代码级别的强依赖，这在强调快速演化的微服务环境下，显得更为合适。

## Spring Boot 和 Spring Cloud 的关系

Spring Boot 关注快速开发单个个体微服务；

Spring Cloud 关注全局，关注多个微服务如何配合并管理；

## 熔断 服务降级

服务熔断的作用类似于我们家用的保险丝，当某服务出现不可用或响应超时的情况时，为了防止整个系统出现雪崩，暂时停止对该服务的调用。

服务降级是从整个系统的负荷情况出发和考虑的，对某些负荷会比较高的情况，为了预防某些功能（业务场景）出现负荷过载或者响应慢的情况，在其内部暂时舍弃对一些非核心的接口和数据的请求，而直接返回一个提前准备好的fallback（退路）错误处理信息。这样，虽然提供的是一个有损的服务，但却保证了整个系统的稳定性和可用性。

## 微服务的优缺点是什么

优点：松耦合，聚焦单一业务功能，无关开发语言，团队规模降低。在开发中，不需要了解多有业务，只专注于当前功能，便利集中，功能小而精。微服务一个功能受损，对其他功能影响并不是太大，可以快速定位问题。微服务只专注于当前业务逻辑代码，不会和 html、css 或其他界面进行混合。可以灵活搭配技术，独立性比较舒服。

缺点：随着服务数量增加，管理复杂，部署复杂，服务器需要增多，服务通信和调用压力增大，运维工程师压力增大，人力资源增多，系统依赖增强，数据一致性，性能监控。

## Reference

1. [什么是微服务](https://mp.weixin.qq.com/s?__biz=MzAxODcyNjEzNQ==&mid=2247500088&idx=1&sn=154900f19d7b4cc15b69d1d22272062d&chksm=9bd36ca0aca4e5b66e7dbe08319fc40b5b3f85c86ccced4ba811ed400d1d04fa9393ded092e5&scene=126&sessionid=1598494414&key=289ce58814d2cb9f48909a97bce25251f85d297000edba7b91ed41fa34466d434e3be8efc859a0cb445d671b81fbfc5a0ede9a0f07f0749a448e349e937ee3fe14b6d84fbb76da04d105b66e133e96993786efe436550c265eacee0e0490a38188064e7fd714ef87055f8c720b251f39b2c90b156023718d72c28d8028aa013e&ascene=1&uin=MjM1Mzc3NDI2Mw%3D%3D&devicetype=Windows+10+x64&version=62090529&lang=zh_CN&exportkey=ASF%2Fb0jOTU8eHpIcbDb%2FW%2Bk%3D&pass_ticket=FVnS7Djt24UIlvI5c2sgpWUr3GiQAMo83KM%2FfVn7jzyIniqV%2F5ZkgsTj8BxHofYl)
