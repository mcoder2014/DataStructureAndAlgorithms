# 索引

索引可以加快数据库查询

## 索引类型

mysql 的索引类型：

* 主键索引 PRIMARYKEY
* 唯一索引 UNIQUE
* 普通索引 INDEX
* 组合索引 （多列索引）
* 全文索引 FULLTEXT

* B-树索引
* 哈希索引
* 空间数据索引
* 全文索引

## 索引优点

1. 减少服务器扫描次数
2. 帮助服务器避免排序和临时表
3. 将随机 IO 变成顺序 IO

### 联合索引性能分析

联合索引例子，where条件中name = fun('A') 和 fun(name)='A'性能区别

### 联合索引生效和失效的条件

## 索引原则

* 独立的列
* 前缀索引多列索引
  * 字符串过长，仅取前缀做为索引
  * 多列索引，按顺序查询
* 聚簇索引
* 覆盖索引

## 索引优化

## 索引失效的原因

1. 查询时在索引列上使用了计算、函数、类型转换等操作；
2. mysql 使用不等于时 ！= 或者 <> 会使用全表扫描；
3. is null is not null 也无法使用索引；
4. **如果条件中有 or**，即使其中有条件带**索引也不会使用**；
5. **对于组合索引（多列）**，**不是使用的第一部分**(第一个)，则不会使用索引；
6. **like查询**是以%开头，不是最左索引（后半段模糊匹配才可以使用索引；
7. 如果列类型是字符串，那一定要在条件中将数据使用引号引用起来,否则不使用索引；
8. **如果 mysql 认为使用全表扫描要比使用索引快,则不使用索引**；

### 联合索引失效的问题

联合索引又叫复合索引。两个或更多个列上的索引被称作复合索引。

对于复合索引：Mysql从左到右的使用索引中的字段，一个查询可以只使用索引中的一部分，但只能是最左侧部分。例如索引是key index （a,b,c）。可以支持a | a,b| a,b,c 3种组合进行查找，但不支持 b,c进行查找 。当最左侧字段是常量引用时，索引就十分有效。

复合索引的结构与电话簿类似，人名由姓和名构成，电话簿首先按姓氏对进行排序，然后按名字对有相同姓氏的人进行排序。如果您知道姓，电话簿将非常有用；如果您知道姓和名，电话簿则更为有用，但如果您只知道名不姓，电话簿将没有用处。

## Reference

1. [【33期】分别谈谈联合索引生效和失效的条件](https://zhuanlan.zhihu.com/p/108179618)
